#!/bin/bash
# GitHubæ¨é€è„šæœ¬

cd "$(dirname "$0")"

echo "ğŸš€ å‡†å¤‡æ¨é€åˆ°GitHub..."
echo ""

# æ£€æŸ¥è¿œç¨‹ä»“åº“
if ! git remote get-url origin > /dev/null 2>&1; then
    echo "âŒ è¿œç¨‹ä»“åº“æœªé…ç½®"
    exit 1
fi

# æ£€æŸ¥æ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹
if [ -n "$(git status --porcelain)" ]; then
    echo "âš ï¸  æœ‰æœªæäº¤çš„æ›´æ”¹ï¼Œæ­£åœ¨æäº¤..."
    git add -A
    git commit -m "chore: æ›´æ–°ä»£ç æ–‡ä»¶"
fi

# å¦‚æœæœ‰ç¯å¢ƒå˜é‡ä¸­çš„tokenï¼Œä½¿ç”¨å®ƒ
if [ -n "$GIT_TOKEN" ]; then
    echo "âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡ä¸­çš„GIT_TOKEN"
    git remote set-url origin "https://hbb8hbb1:${GIT_TOKEN}@github.com/hbb8hbb1/HH.git"
    git push -u origin main
else
    echo "ğŸ“ è¯·æä¾›GitHub Personal Access Token (PAT)"
    echo ""
    echo "æ–¹å¼1: è®¾ç½®ç¯å¢ƒå˜é‡åè¿è¡Œæ­¤è„šæœ¬"
    echo "  export GIT_TOKEN='your-token'"
    echo "  ./push_to_github.sh"
    echo ""
    echo "æ–¹å¼2: ç›´æ¥æ¨é€ï¼ˆä¼šæç¤ºè¾“å…¥ç”¨æˆ·åå’Œtokenï¼‰"
    echo "  git push -u origin main"
    echo "  ç”¨æˆ·å: hbb8hbb1"
    echo "  å¯†ç : <ä½ çš„GitHub Token>"
    echo ""
    echo "æ–¹å¼3: æ‰‹åŠ¨è®¾ç½®è¿œç¨‹URL"
    echo "  git remote set-url origin https://hbb8hbb1:YOUR_TOKEN@github.com/hbb8hbb1/HH.git"
    echo "  git push -u origin main"
fi
