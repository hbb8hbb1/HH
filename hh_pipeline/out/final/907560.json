{
  "title": "Google Product Analyst 面试失败经验分享：SQL 与因果推断案例考察",
  "originalContent": "<div class=\"article_body\"><td class=\"t_f\" id=\"postmessage_17325750\" itemprop=\"articleBody\">\n一上来先自我介绍，然后walk through project，先是一道sql题，应该是google map里面餐厅的rating data，有user_id, timestamp, location_name (has duplicate values), location_id, rating (has null values) 还有几个不太重要的columns。1. 问unique users有多少个？<br/>\n这个楼主直接select (distinct user_id)<br/>\n2. 如果只考虑user的most updated rating（因为同一个人可能会对某个餐馆有不同的评价），每一个restaurant的avg rating是什么？<br/>\n用window function<br/>\nwith tb1 as (select loc_id, user_id, rating, rank() over (partition by loc_id, user_id order by timestamp desc) as ranking from table1)<br/>\nselect loc_id, avg(rating) as avg_rating from tb1 where ranking = 1 group by 1<br/>\n3. 面试官提醒要Exclude null ratings，还有output table里面想看到location name，楼主就直接在前面的cte里面加了rating is not null (面试官好像这里有点停顿，但是也没打断我，不知道这里是不是踩了雷。。）然后最后弄了个left join把location name搞进来。<br/>\n<br/>\n后来就是一个case，说给subset of 一个ecommerce website customers发promo 邮件，这个邮件已经发出去了，而且已知不是ab test，问你怎么去measure the impact of what we have done。<br/>\n楼主刚开始听到promo邮件，就想从email marketing click through rate回答，success metrics选择了click through rate, site landing rate, 还有revenue（面试官说希望main metric是revenue）。楼主就说取两组人，都是people who landed on site：一组是没有用这个email的折扣码， 还有一组用了折扣码，比较两组的revenue。两组尽量同样的size。具体分析的时候，可以画个图，比较这两组的revenue的变化，尽量排除seasonality, novelty, primacy, day of the week那些effect，接着面试官问用什么test，楼主就说用t test，面试官接着问t test有什么assumption，楼主就解释了一下Normality, independence, 跟random。<br/>\n<br/>\n面的过程感觉没踩什么雷（也许踩了但我没发现T_T)，不知道为什么挂了，求大神解惑！！<br/>\n<br/>\n</td></div>",
  "processedContent": "## 基本信息（公司/岗位/结果/难度）\n- **公司**：Google\n- **岗位**：Product Analyst\n- **结果**：未通过\n- **难度**：4\n\n## 时间线\n未提及/不明确\n\n## 面试过程\n### 一轮面试（技术+案例分析）\n1. **自我介绍**：面试官要求候选人进行简要自我介绍。\n2. **项目阐述**：候选人被要求详细讲解一段过往项目经历（walk through project）。\n3. **SQL 题目**：基于模拟的 Google Maps 餐厅评分数据表，包含字段：`user_id`, `timestamp`, `location_name`（有重复值），`location_id`, `rating`（存在空值）等。\n   - **问题1**：统计唯一用户数量。\n     - 候选人回答：`SELECT COUNT(DISTINCT user_id)`\n   - **问题2**：若每个用户对同一餐厅仅保留最新一次评分，计算每个餐厅的平均评分。\n     - 使用窗口函数处理，按 `location_id` 和 `user_id` 分组，按时间倒序排序取最新记录。\n     - 回答示例：\n       ```sql\n       WITH tb1 AS (\n         SELECT loc_id, user_id, rating,\n                RANK() OVER (PARTITION BY loc_id, user_id ORDER BY timestamp DESC) AS ranking\n         FROM table1\n       )\n       SELECT loc_id, AVG(rating) AS avg_rating\n       FROM tb1\n       WHERE ranking = 1\n       GROUP BY loc_id;\n       ```\n   - **问题3**：排除 `rating` 为 NULL 的记录，并在输出中包含 `location_name`。\n     - 候选人在 CTE 中加入 `rating IS NOT NULL` 条件，之后通过 `LEFT JOIN` 关联获取 `location_name`。\n     - 面试官略有停顿，但未明确指出错误，可能存在优化空间。\n4. **产品分析案例题**：针对已向部分电商网站客户发送促销邮件（非 A/B 测试）的情况，如何评估该活动的影响？\n   - 候选人初始提出使用点击率、落地页转化率和收入作为指标，面试官强调主要关注 **收入（revenue）**。\n   - 最终方案：将访问站点的用户分为两组——使用折扣码 vs 未使用折扣码，比较其收入表现。\n   - 控制变量建议：控制季节性、新奇效应、首因效应、周几等因素影响。\n   - 统计检验方法：提出使用 t-test，并解释其假设条件：正态性、独立性、随机抽样。\n\n## 题目总结\n- SQL 查询类：\n  - 统计唯一用户数\n  - 按用户-地点维度取最新评分并计算平均分\n  - 处理空值 & 关联补充字段（location name）\n- 产品分析类：\n  - 如何衡量非实验性促销邮件的业务影响\n  - 核心指标选择（revenue 为主）\n  - 对照组设计思路（使用 vs 未使用折扣码）\n  - 统计检验方法及其前提假设（t-test 及其 assumptions）\n\n## 个人总结\n- 整体面试流程顺畅，未明显感觉失误，但仍遗憾挂掉。\n- 可能潜在问题点：\n  - 在 SQL 中提前过滤 `rating IS NOT NULL` 是否合理？是否应放在外层更合适？需注意逻辑顺序与执行计划差异。\n  - 案例中对照组并非随机分配，存在选择偏差（selection bias），使用“是否使用折扣码”作为分组可能引入混淆因素，理想做法可考虑 PSM 或 DID 方法，但面试中未提及。\n- 建议后续准备者：\n  - 强化因果推断思维，在无 A/B 实验时能识别观察性数据局限。\n  - 熟练掌握 SQL 窗口函数及 NULL 值处理细节。\n  - 明确统计检验的前提条件，并能结合业务场景灵活应用。",
  "company": "Google",
  "role": "Product Analyst",
  "difficulty": 4,
  "tags": [
    "Product Analyst",
    "SQL",
    "Case Interview",
    "Causal Inference",
    "Statistics",
    "Behavioral & Fit",
    "On-site Interview"
  ],
  "comments": [],
  "usefulVotes": 0,
  "uselessVotes": 0,
  "shareCount": 0,
  "isAnonymous": true
}